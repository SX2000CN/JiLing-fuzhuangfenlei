# Tasks: add-interaction-animations

## 阶段一：动画基础设施

### 1. 创建动画管理器

- [x] 创建 `src/gui/animations/` 目录
- [x] 实现 `AnimationManager` 单例类
  - [x] `enabled` 全局开关
  - [x] `duration_multiplier` 时长倍率
  - [x] `create_animation()` 工厂方法
- [x] 实现 spring 缓动曲线（使用 `QEasingCurve.OutBack` 近似）
- [x] 在 `src/gui/animations/__init__.py` 中导出

**验证**: 单元测试动画创建和缓动曲线

### 2. 添加动画预设

- [x] 实现 `fade_in()` / `fade_out()` 预设
- [x] 实现 `scale_press()` / `scale_release()` 预设
- [x] 实现 `slide_in()` / `slide_out()` 预设
- [x] 实现 `expand_width()` / `collapse_width()` 预设

**验证**: 预设动画可正常播放

---

## 阶段二：按钮动画

### 3. SidebarButton 动画

- [x] 添加 hover 背景色渐变动画
- [x] 添加 hover 图标缩放动画 (1.0 -> 1.05)
- [x] 添加 press 缩放动画 (1.0 -> 0.95)
- [x] 添加 release spring 弹回动画

**验证**: 侧边栏按钮交互流畅

### 4. ActionButton 动画

- [x] 添加 hover 背景色渐变（通过 CSS transition）
- [x] 添加 press/release 缩放动画（复用 SidebarButton 机制）
- [x] 确保禁用状态无动画

**验证**: 操作按钮交互流畅

---

## 阶段三：组件动画

### 5. VSCheckBox 动画

- [x] 添加背景色渐变动画
- [x] 添加勾选标记绘制动画（路径动画）
- [x] 添加取消勾选淡出动画

**验证**: 复选框切换有动画效果

### 6. 进度条动画

- [x] 创建 `AnimatedProgressBar` 组件
- [x] 为 `setValue()` 添加数值平滑过渡
- [x] 导出到 components 模块

**验证**: 进度条数值变化平滑

### 7. 输入框聚焦动画

- [x] 通过 CSS transition 实现边框颜色渐变
- [x] 聚焦时边框高亮效果

**验证**: 输入框聚焦有视觉反馈

---

## 阶段四：页面动画

### 8. 页面切换动画

- [x] 修改 `_switch_page()` 方法
- [x] 实现淡入动画
- [x] 动画完成后切换 `currentIndex`

**验证**: 页面切换有流畅过渡效果

### 9. 主题切换动画

- [x] 主题切换时组件自动更新（通过信号机制）
- [x] 颜色变化通过组件重绘实现

**验证**: 主题切换有渐变效果

---

## 阶段五：设置与优化

### 10. 动画设置选项

- [x] 在 `SettingsManager` 中添加 `appearance.animations_enabled` 配置
- [x] 在 `_load_settings()` 中应用动画开关
- [x] 禁用时所有动画时长设为 0

**验证**: 设置开关可控制动画

### 11. 性能优化

- [x] 动画管理器单例模式避免重复创建
- [x] 动画开始前停止之前的动画
- [x] 使用 `_get_duration()` 统一控制时长

**验证**: 动画不影响界面响应速度

---

## 依赖关系

```
任务 1 (动画管理器) ← 无依赖
任务 2 (动画预设) ← 依赖任务 1
任务 3-7 (组件动画) ← 依赖任务 1, 2
任务 8 (页面动画) ← 依赖任务 1, 2
任务 9 (主题动画) ← 依赖任务 1, 2
任务 10 (设置) ← 依赖任务 1
任务 11 (优化) ← 依赖任务 1-9
```

## 可并行任务

- 任务 3-7 可以并行开发
- 任务 8, 9 可以并行开发

## 预估工作量

| 任务              | 预估时间 | 复杂度 | 状态      |
| ----------------- | -------- | ------ | --------- |
| 1. 动画管理器     | 1.5小时  | 中     | ✅ 完成   |
| 2. 动画预设       | 1小时    | 低     | ✅ 完成   |
| 3. SidebarButton  | 1小时    | 中     | ✅ 完成   |
| 4. ActionButton   | 30分钟   | 低     | ✅ 完成   |
| 5. VSCheckBox     | 1小时    | 中     | ✅ 完成   |
| 6. 进度条         | 30分钟   | 低     | ✅ 完成   |
| 7. 输入框         | 30分钟   | 低     | ✅ 完成   |
| 8. 页面切换       | 1.5小时  | 中     | ✅ 完成   |
| 9. 主题切换       | 1小时    | 中     | ✅ 完成   |
| 10. 设置选项      | 30分钟   | 低     | ✅ 完成   |
| 11. 性能优化      | 1小时    | 中     | ✅ 完成   |
| **总计**          | **~10小时** | -   | **全部完成** |
