# 加载与状态

## 概述

加载状态是用户等待系统响应时的体验关键。良好的加载设计能够减少用户焦虑、传达系统状态、保持用户参与度。

## 设计原则

- **即时反馈**：操作后立即显示加载状态
- **进度可见**：尽可能显示具体进度
- **保持参与**：避免空白等待
- **优雅降级**：超时和错误有备选方案

## 加载类型

### 按范围分类

| 类型 | 范围 | 示例 |
|------|------|------|
| 全局加载 | 整个页面 | 页面跳转 |
| 区域加载 | 部分区域 | 列表刷新 |
| 组件加载 | 单个组件 | 按钮提交 |
| 内联加载 | 元素内部 | 图片加载 |

### 按进度分类

| 类型 | 进度 | 适用场景 |
|------|------|----------|
| 确定进度 | 已知 | 文件上传/下载 |
| 不确定进度 | 未知 | 数据请求 |

## 加载指示器

### 旋转器（Spinner）

| 尺寸 | 像素 | 场景 |
|------|------|------|
| xs | 12px | 内联文字 |
| sm | 16px | 按钮内 |
| md | 24px | 卡片内 |
| lg | 32px | 区域中心 |
| xl | 48px | 页面中心 |

### 进度条（Progress Bar）

| 类型 | 用途 |
|------|------|
| 线性确定 | 文件上传、安装进度 |
| 线性不确定 | 页面顶部加载 |
| 环形确定 | 技能图、完成度 |
| 环形不确定 | 加载中 |

### 骨架屏（Skeleton）

```
┌─────────────────────────────────────┐
│ ████████████████                    │  ← 标题
│ ████████████████████████████████    │  ← 描述
│ ████████████████████████            │
│                                     │
│ ┌────────┐ ┌────────┐ ┌────────┐   │  ← 卡片
│ │ ░░░░░░ │ │ ░░░░░░ │ │ ░░░░░░ │   │
│ │ ░░░░░░ │ │ ░░░░░░ │ │ ░░░░░░ │   │
│ └────────┘ └────────┘ └────────┘   │
└─────────────────────────────────────┘
```

**动画**：光泽扫过效果（Shimmer）

## 加载场景

### 页面加载

| 阶段 | 处理 |
|------|------|
| 0-300ms | 无特殊处理 |
| 300ms-1s | 显示骨架屏 |
| 1s-3s | 骨架屏+加载提示 |
| >3s | 进度指示+取消选项 |

### 按钮加载

```
[ 提交 ] → [ ⟳ 提交中... ] → [ ✓ 成功 ]
```

| 状态 | 样式 |
|------|------|
| 加载中 | 禁用+旋转器+文字 |
| 成功 | 绿色+勾选图标 |
| 失败 | 恢复原状+错误提示 |

### 列表加载

| 模式 | 触发 | 指示器 |
|------|------|--------|
| 下拉刷新 | 下拉手势 | 顶部旋转器 |
| 上拉加载 | 滚动到底 | 底部旋转器 |
| 分页加载 | 点击页码 | 列表区域 |

### 图片加载

| 策略 | 描述 |
|------|------|
| 占位符 | 灰色背景或模糊预览 |
| 渐进加载 | 从模糊到清晰 |
| 懒加载 | 进入视口时加载 |

## 加载优化

### 感知性能

| 技术 | 效果 |
|------|------|
| 骨架屏 | 减少空白感 |
| 乐观更新 | 假设成功先更新UI |
| 预加载 | 提前加载可能需要的资源 |
| 渐进渲染 | 先显示关键内容 |

### 实际性能

| 技术 | 效果 |
|------|------|
| 代码分割 | 按需加载 |
| 资源压缩 | 减少传输量 |
| 缓存策略 | 减少重复请求 |
| CDN | 就近获取资源 |

## 状态管理

### 数据状态

```
┌─────────┐
│  空闲   │
└────┬────┘
     │ 请求
     ▼
┌─────────┐
│  加载   │
└────┬────┘
     │
     ├─── 成功 ───→ 有数据 / 空数据
     │
     └─── 失败 ───→ 错误状态
```

### 状态展示

| 状态 | 展示 |
|------|------|
| 加载中 | 骨架屏/旋转器 |
| 有数据 | 正常内容 |
| 空数据 | 空状态引导 |
| 错误 | 错误提示+重试 |

## 平台差异

### 网页端
- 页面顶部进度条
- 骨架屏广泛使用
- 支持后台加载

### 移动端
- 下拉刷新
- 原生加载指示器
- 触觉反馈
- 避免阻塞交互

### 桌面端
- 任务栏进度
- 系统通知完成
- 后台静默加载

## 无障碍考虑

- 使用 `aria-busy="true"`
- 进度条 `role="progressbar"`
- 提供文字描述
- 加载完成后通知

## 最佳实践

### ✅ 推荐
- 300ms 后才显示加载
- 使用骨架屏而非空白
- 显示具体进度
- 提供取消选项

### ❌ 避免
- 长时间无反馈
- 阻塞所有交互
- 加载完成无提示
- 忽略错误处理

## 相关规范

- [反馈组件](规范_02_组件规范_反馈组件.md)
- [错误处理](规范_03_交互模式_错误处理.md)

---

[返回主目录](README.md)